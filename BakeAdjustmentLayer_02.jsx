<javascriptresource>	<name>Bake Adjustment Layer (v0.8)</name>	<menu>filter</menu>	<category>Viera</category>	<about>This will bake the selected adjustment layers to ALL layers below. - by Evan Viera</about>	<enableinfo>true</enableinfo></javascriptresource>var doc = activeDocument;var layerToCopy = doc.activeLayer;var myParent = layerToCopy.parent;var allLayers = [];doc.selection.selectAll();doc.selection.copy(true);//doc.selection.deselect();//	Get Index of LayerToCopyvar layerIndex = 0;while (myParent.layers[layerIndex] != layerToCopy) {	layerIndex++;}var isClipping = layerToCopy.grouped;var layerTypeName = myParent.layers[layerIndex+1].typename;if ((isClipping == true) && (layerTypeName == "LayerSet")) {	allLayers = collectAllLayers(myParent.layers[layerIndex+1], allLayers);}else {	allLayers = collectAllLayers(myParent, allLayers);}for ( var i = 0; i < allLayers.length; i++ ) {	var copiedLayer = layerToCopy.duplicate( allLayers[i], ElementPlacement.PLACEBEFORE );	if (copiedLayer.grouped == false) copiedLayer.grouped = true;	copiedLayer.merge();}layerToCopy.remove();var proof = doc.paste(true);	proof.name = "PROOF";	proof.move(doc.layers[0], ElementPlacement.PLACEBEFORE);	proof.visible = false;function collectAllLayers (doc, allLayers){    for (var m = layerIndex; m < doc.layers.length; m++){		        var theLayer = doc.layers[m];        if (theLayer.typename == "ArtLayer") {			if (theLayer.visible == true) {				if (theLayer.kind == LayerKind.NORMAL) {					allLayers.push(theLayer);									}			}        }		else {            collectAllLayers(theLayer, allLayers);        }				if ((isClipping == true) && (doc.layers[m].grouped == false) && (layerTypeName != "LayerSet")) {			return allLayers;		}    }    return allLayers;}